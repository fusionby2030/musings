<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>On the bootstrap current in tokamaks</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="bootstrap_current_files/libs/clipboard/clipboard.min.js"></script>
<script src="bootstrap_current_files/libs/quarto-html/quarto.js"></script>
<script src="bootstrap_current_files/libs/quarto-html/popper.min.js"></script>
<script src="bootstrap_current_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="bootstrap_current_files/libs/quarto-html/anchor.min.js"></script>
<link href="bootstrap_current_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="bootstrap_current_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="bootstrap_current_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="bootstrap_current_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="bootstrap_current_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">On the bootstrap current in tokamaks</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>To achieve fusion, we need to confine the plasma for sufficient time. Without instabillities, the majority of confinement comes from Coulomb collisions, but transport of particles and energy is generally not so simple, leading to anamolous transport mechanisms.</p>
<p>In a cylindrical plasma, the collisional transport of particles and energy boils down to a diffusion process. Particles collide with a characteristic rate time <span class="math inline">\(\tau_c\)</span>. The collision allows the particles to ‘step’ accross magnetic field with a step length equal to their <a href="https://en.wikipedia.org/wiki/Gyroradius">larmor radius</a>, <span class="math inline">\(\rho\)</span>. This yields us a diffusion coefficient, <span class="math inline">\(\mathcal{D} \sim \rho^2 / \tau_c\)</span>, of particles and energy diffusing radially outwards.</p>
<p>For a toroidal plasma with twisted helical field lines, this is not the case, which is why transport in toroidal plasma is refered to as <em>neoclassical transport</em>. An example of such a change in transport is <em>banana transport</em>.</p>
<section id="gradient-drift" class="level3">
<h3 class="anchored" data-anchor-id="gradient-drift">Gradient drift</h3>
<p>The magnetic field strength is not toroidally uniform; it is strongest closest to the donut hole, the high field side (HFS), gradually getting weaker radially outwards the edge, the low field side (LFS) (see the <a href="#fig-full">Fig.&nbsp;1 (a)</a>). The drift in particle velocity due to the gradient of the magnetic field <span id="eq-drift"><span class="math display">\[v_D^{\nabla \vec{B}} = - \frac{W_\perp}{q} \frac{\nabla_T \vec{B} \times \vec{B}}{B^3} \tag{1}\]</span></span></p>
</section>
<section id="banana-regime" class="level3">
<h3 class="anchored" data-anchor-id="banana-regime">Banana regime</h3>
<p>Due to the drift velocity, Particles with <span class="math inline">\(v_{||} &lt; v_\perp\)</span> (parallel/perpendicular to magnetic field lines) can be reflected from LFS to HFS, similar to the <a href="https://en.wikipedia.org/wiki/Magnetic_mirror">magnetic mirror</a>. This has the result that no full poloidal turn is possible (<a href="#fig-banana-simulation">Fig.&nbsp;1</a>) and the particles are <em>trapped</em> in the LFS.</p>
<div id="fig-banana-simulation" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-full" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./local_figures/Banana_orbits_with_notations.jpg" class="img-fluid figure-img" data-ref-parent="fig-banana-simulation"></p>
<p></p><figcaption class="figure-caption">(a) Toroidal view</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-partial-cross-section" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./local_figures/banana_orbits_2.png" class="img-fluid figure-img" data-ref-parent="fig-banana-simulation"></p>
<p></p><figcaption class="figure-caption">(b) Partial cross section</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-cross-section" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./local_figures/banana_orbit_3.png" class="img-fluid figure-img" data-ref-parent="fig-banana-simulation"></p>
<p></p><figcaption class="figure-caption">(c) Cross section</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: The banana particle orbits as taken from <a href="https://www.youtube.com/watch?v=1fCkCHMNgKw">Alfs lecture 21</a>. The reflection direction is determined by the drift velocity.</figcaption><p></p>
</figure>
</div>
<p>The trapped particles transport energy differently. Then of interest is the fraction of trapped particles, <span class="math inline">\(f_t = \sqrt{2\epsilon}\)</span>, for a Maxwellian distribution of velocities, where <span class="math inline">\(\epsilon = a/R\)</span>.</p>
</section>
<section id="bootstrap-current" class="level2">
<h2 class="anchored" data-anchor-id="bootstrap-current">Bootstrap current</h2>
<p>Due to the toroidal electric field, the radial current density profile is not flat. Friction related to transport from particles in banana orbit (collisions between trapped and non-trapped particles) leads to a diffusion driven current, otherwise known as the bootstrap current. This is different than the conventional current from the central solenoid.</p>
<p>The current is brought on by the change in the <span class="math inline">\(\nabla_T \vec{B} \times \vec{B}\)</span> component from LFS to HFS, as the <span class="math inline">\(B_{pol}\)</span> is rotating around the outer plamsa, and <span class="math inline">\(\nabla \vec{B}\)</span> constant pointing inwards from the drift. This corresponds to the following additional drifts:</p>
<ul>
<li>For particles near the LFS, i.e., <span class="math inline">\(r &gt; R\)</span>, we will get a drift (with charge dependence due to eq. <a href="#eq-drift">Eq.&nbsp;1</a>)
<ul>
<li>ions: in the direction of the current</li>
<li>electrons: opposite direction of current</li>
</ul></li>
<li>For particles near HFS:
<ul>
<li>ions: opposite direction of the current</li>
<li>electrons: opposite direction of current</li>
</ul></li>
</ul>
<p>Since particles spend a longer time in the reflecting stage of the banana orbit (??), there is a <strong>resulting net drift in the direction of the current</strong>, as the trapped particlestransfer momentum to passing particles carrying the current.</p>
<p>The name derives itself from the idea that the particles themselves are contributing to the confining poloidal field, hence the plasma itself is bootstraping its confinement, <a href="https://erikjanvankesteren.nl/blog/2018-03-01-baron-bootstrap.html">pulling oneself</a>.</p>
<p>A simple quantitive estimation is <span class="math inline">\(j_{bs} = -\sqrt{\epsilon} \frac{1}{B_\theta} \frac{dp}{dr}\)</span>, where the <span class="math inline">\(B_\theta\)</span> the poloidal field strength and <span class="math inline">\(p\)</span> the plasma pressure.</p>
<p>The bootstrap current is important for stability analysis.</p>
<div class="cell" data-fig-label="fig-example-boostrap-currents" data-execution_count="2">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="bootstrap_current_files/figure-html/cell-3-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">With a steeper pressure gradient, e.g., in H-mode, we have a larger boostrap current</figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="very-complicated-formula-that-i-use" class="level3">
<h3 class="anchored" data-anchor-id="very-complicated-formula-that-i-use">Very complicated formula that I use</h3>
<p>In<span class="citation" data-cites="wesson"><sup><a href="#ref-wesson" role="doc-biblioref">1</a></sup></span>:</p>
<p><span class="math display">\[\langle \vec{j}_b \cdot \vec{B} \rangle = \frac{\mu_0 f(\Psi) x p_e}{D(x)} \left( c_1 \frac{\nabla p_e}{p_e} + c_2 \frac{\nabla p_i}{p_i}  + c_3 \frac{\nabla T_e}{T_e} + c_4 \frac{\nabla T_i}{T_i} \right)\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(f(\Psi) = RB_\phi(\Psi) / \mu_0\)</span>
<ul>
<li>If we want to do this integral approximation, we will need to transform the magnetic field into flux coordinates…</li>
</ul></li>
<li><span class="math inline">\(x\)</span> is ratio of number of trapped to circulating particles, which can be approximated to <span class="math inline">\(\simeq \sqrt{2}\epsilon^{1/2}\)</span> with <span class="math inline">\(\epsilon=a/R\)</span>
<ul>
<li>For <span class="math inline">\(D(x) = 2.4 + 5.4x + 2.6x^2\)</span> and used sporatically in below coefficients</li>
</ul></li>
<li><span class="math inline">\(c_1 = \frac{4.0 + 2.6x}{(1+0.2\nu_{*e}^{1/2} + 1.07\nu_{*e})(1+1.07\epsilon^{3/2}\nu_{*e})}\)</span></li>
<li><span class="math inline">\(c_2 = \frac{T_i}{T_e} c_1\)</span></li>
<li><span class="math inline">\(c_3 = \frac{7.0 + 6.5x}{(1+0.57\nu_{*e}^{1/2} + 0.61\nu_{*e})(1+0.61\epsilon^{3/2}\nu_{*e})} - \frac{5}{2}c_1\)</span></li>
<li><span class="math inline">\(c_4 = \left( \frac{d+0.35\nu_{*i}^{1/2}}{1+0.7\nu_{*i}^{1/2}} +2.1\epsilon^3\nu_{*i}^{2}\right) \frac{1}{(1+\epsilon^3\nu_{*i}^{2})(1+ \epsilon^3\nu_{*e}^{2})}c_2\)</span>
<ul>
<li><span class="math inline">\(d = \frac{1.17}{1+0.46x}\)</span></li>
</ul></li>
<li><span class="math inline">\(\nu_{*j}=\frac{\nu_j}{\epsilon \omega_{bj}}\)</span>
<ul>
<li>where <span class="math inline">\(\nu_e = \tau_e^{-1}\)</span>, <span class="math inline">\(\nu_i = \tau_i^{-1}\)</span> and <span class="math inline">\(\omega_{bj} = \epsilon^{1/2}(T_j/m_j)^{1/2} / Rq\)</span>
<ul>
<li>where the electron collision time for electron collisions with ions is defined as <span class="math inline">\(\tau_e = \frac{12\pi^{3/2}}{\sqrt{2}}\frac{\epsilon_0 m_e^{1/2}T_e^{3/2}}{n_iZ^2e^4\ln \Lambda}\)</span> but can be simplified for singly charged ions to be <span class="math inline">\(6.4\times 10^{14} \frac{T_e^{3/2}}{n}\)</span>, with <span class="math inline">\(\ln \Lambda = 17\)</span> and <span class="math inline">\(T_e\)</span> in keV.</li>
<li>where the ion collision time characterizing ion collisions with other ions <span class="math inline">\(\tau_i = 12\pi^{3/2} \frac{\epsilon_0^2 m_i^{1/2}T_i^{3/2}}{n_iZ^4e^4\ln\Lambda_i}\)</span>; <span class="math inline">\(\Lambda_i = 1.1\Lambda\)</span> but can be simplified for singly charged ions to be <span class="math inline">\(6.6\times 10^{17} \left( \frac{m_i}{m_p}\right)^{1/2} \frac{T_i^{3/2}}{n\ln\Lambda_i}\)</span> for <span class="math inline">\(T_i\)</span> in keV</li>
</ul></li>
</ul></li>
</ul>
<p>We can make even more simplifying assumptions, namely <span class="math inline">\(n_e \approx n_i\)</span>, <span class="math inline">\(T_e \approx T_i\)</span> <span class="math inline">\(\Rightarrow p_e = p_i\)</span>, reducing to</p>
<p><span class="math display">\[ j_b = \langle \vec{j}_b \cdot \vec{B} \rangle = \frac{\mu_0 f(\Psi) x p_e}{D(x)} \left( 2(c_1 + c_2)\frac{\nabla p_e}{p_e} + 2(c_3 + c_4)\frac{\nabla T_e}{T_e}\right)\]</span></p>
</section>
</section>
<section id="fun-facts" class="level2">
<h2 class="anchored" data-anchor-id="fun-facts">Fun facts</h2>
<p>Although one would want to maximize the bootstrap current, in stellarators we actually minimize it as to not fuck up the delicate magnetic geometry.</p>

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-line-spacing="2" role="doc-bibliography">
<div id="ref-wesson" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Wesson, J. <em><a href="https://cds.cern.ch/record/1427009"><span class="nocase">Tokamaks; 3th ed.</span></a></em> (Oxford Univ. Press, 2011).</div>
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>